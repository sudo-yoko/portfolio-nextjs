# インストール

コマンド

```
npx create-next-app@latest my-app-16
```

実行結果ログ

```
Need to install the following packages:
create-next-app@16.0.1
Ok to proceed? (y) y
✔ Would you like to use the recommended Next.js defaults? › No, customize settings
✔ Would you like to use TypeScript? … No / *Yes
✔ Which linter would you like to use? › ESLint
✔ Would you like to use React Compiler? … *No / Yes
✔ Would you like to use Tailwind CSS? … No / *Yes
✔ Would you like your code inside a `src/` directory? … No / *Yes
✔ Would you like to use App Router? (recommended) … No / *Yes
✔ Would you like to use Turbopack? (recommended) … No / *Yes
✔ Would you like to customize the import alias (`@/*` by default)? … *No / Yes
Creating a new Next.js app in /workspaces/portfolio-nextjs/my-app-16.

Using npm.

Initializing project with template: app-tw 


Installing dependencies:
- react
- react-dom
- next

Installing devDependencies:
- typescript
- @types/node
- @types/react
- @types/react-dom
- @tailwindcss/postcss
- tailwindcss
- eslint
- eslint-config-next


added 366 packages, and audited 367 packages in 1m

145 packages are looking for funding
  run `npm fund` for details

found 0 vulnerabilities

Generating route types...
✓ Route types generated successfully

Success! Created my-app-16 at /workspaces/portfolio-nextjs/my-app-16
```

# プロジェクトのモジュール形式

### package.json
```
{
  "name": "my-app-16",
  "version": "0.1.0",
  "private": true,
  "type": "module",   // ★これを指定する
  "scripts": {
    "dev": "next dev",
    "build": "next build",
    "start": "next start",
    "lint": "eslint",
    ...
}
```
* "type": "module" - プロジェクト全体を ESM(ESModules) で統一する。

### tsconfig.json
```
{
  "compilerOptions": {
    "target": "ES2017",
    "lib": ["dom", "dom.iterable", "esnext"],
    "allowJs": true,
    "skipLibCheck": true,
    "strict": true,
    "noEmit": true,
    "esModuleInterop": true,
    "module": "esnext",                 // ★これを指定する
    "moduleResolution": "bundler",      // ★これを指定する
    "resolveJsonModule": true,
    "isolatedModules": true,
    ...
}
```

# APIモック(Express)

* tsx をインストール
```
npm install -D tsx
```
* コードは .ts ファイルで作成する。
* 起動スクリプト
```js
// package.json
{
  "name": "my-app-16",
  "version": "0.1.0",
  "private": true,
  "type": "module",
  "scripts": {
    "dev": "next dev",
    "build": "next build",
    "start": "next start",
    "lint": "eslint",
    "mock1": "tsx watch __mocks__/customers.ts"  // ★起動スクリプト
  },
  ...
}
```
watch - ソースコードを監視し、ファイルが変更されるたびに自動で再実行するモード。

* アプリケーション本体とAPIモックを一緒に起動できるようにする。
```
npm install -D npm-run-all
```
```js
// package.json

{
  "name": "nextjs",
  "version": "0.1.0",
  "private": true,
  "type": "module",
  "scripts": {
    "dev": "next dev",
    "build": "next build",
    "start": "next start",
    "lint": "next lint",
    "mock1": "tsx watch __mocks__/customers.ts",
    "dev:mock": "npm-run-all --parallel dev mock1",  // ★起動スクリプト
  ...
}
```

# Prettier

インストール
```
npm install --save-dev prettier prettier-plugin-tailwindcss
```

設定ファイルを作成
``` bash
echo > .prettierrc.cjs
```
* .prettierrcだとJSON形式のためコメントが記述できない。コメントを記述できるように.jsファイルで作成し、かつCommonJS形式とする。

# ESLint

```
npm install --save-dev eslint-config-prettier
```

eslint-config-prettier - Prettier と競合する ESLint の整形系ルールを無効化するプラグイン。  
なお、ESLint に Prettierを組み込んで実行する（Prettier を ESLint ルールとして走らせる）やり方は現在は非推奨。Prettier はフォーマッタとして単体で動かし、ESLint は品質チェック、eslint-config-prettier で競合する ESLint の整形系ルールを無効化する。

eslint.config.mjs
``` js
import nextVitals from "eslint-config-next/core-web-vitals";
import nextTs from "eslint-config-next/typescript";
import { defineConfig, globalIgnores } from "eslint/config";
import eslintConfigPrettier from "eslint-config-prettier"; // ★これを追加

const eslintConfig = defineConfig([
  ...nextVitals,
  ...nextTs,
  globalIgnores([".next/**", "out/**", "build/**", "next-env.d.ts"]),
  eslintConfigPrettier, // ★これを追加。配列の最後に書くのがポイント
]);

export default eslintConfig;
```


